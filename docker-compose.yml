version: '3.8'
services:
  app:
    build:
      context: .
      dockerfile: Dockerfile
    # For CI-driven deploy we publish to GHCR and pull on hosts.
    # CI pushes to ghcr.io/sonozakiSZ/guild-mng-bot:latest
    image: ghcr.io/sonozakiSZ/guild-mng-bot:latest
    container_name: guild-mng-bot
    restart: unless-stopped
    volumes:
      - ./logs:/app/logs
      - ./storage:/app/storage
    environment:
      DISCORD_TOKEN: ${DISCORD_TOKEN}
      DISCORD_APP_ID: ${DISCORD_APP_ID}
      LOCALE: ${LOCALE:-ja}
      DATABASE_URL: ${DATABASE_URL:-sqlite://storage/db.sqlite}
    env_file:
      - .env

volumes:
  logs:
  storage:
